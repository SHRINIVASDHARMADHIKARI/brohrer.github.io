<!DOCTYPE html>
<html>

  <script type="text/javascript">var blog_title = "How model selection works, Part 1";</script>
  <script type="text/javascript">var publication_date = "November 10, 2018";</script>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <base target="_blank">
    <script type="text/javascript" src="javascripts/blog_head.js"></script>
  </head>
  <body>
    <script type="text/javascript" src="javascripts/blog_header.js"></script>
    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">


        <ul>
          <li>
            <a href="how_modeling_works_1.html">Part 1: Choosing between models [post]</a> &nbsp
            <a href="">[video]</a> &nbsp
          </li>
          <li>
            <a href="how_modeling_works_2.html">Part 2: Choosing a loss function [post]</a> &nbsp
            <a href="">[video]</a> &nbsp
          </li>
          <li>
            <a href="how_modeling_works_3.html">Part 3: Splitting the data [post]</a> &nbsp
            <a href="">[video]</a> &nbsp
          </li>
          <li>
            <a href="how_modeling_works_4.html">Part 4: Hypothesis-driven modeling [post]</a> &nbsp
            <a href="">[video]</a> &nbsp
          </li>
          <li>
            <a href="https://docs.google.com/presentation/d/1SUS4Sd-RJQBZhwO4rYEt6xYJGey7EBfNO1zBfrqGHF0/edit?usp=sharing">
              [slides]</a>
            <a href="https://github.com/brohrer/how_modeling_works/">[code]</a>
          </li>
        </ul>
        
        <p>
	  Let’s fit a model to some data. These are the annual temperatures for the last 120 years in a fictional Midwestern town. There’s one point per year, the annual median of the daily high temperatures. When we look at it, our eye is really good at pulling out a pattern. There’s a clear lift toward the right hand side. We would like to capture that in a model.
        </p>

        <img src="images/how_modeling_works/Typical_daily_highs.png" style="width: 600px;" />

        <p>
	  There are a lot of models that can represent this. A really nice starting point, because it so simple, is a straight line. Here’s what the best fit straight line looks like. It does a pretty good job. We can see that it definitely captures the upward tilt of the data. But it doesn’t capture the bend in it. It’s clear when we examine it, that a straight line doesn’t do quite as well as we would like.
        </p>

        <img src="images/how_modeling_works/Linear_model.png" style="width: 600px;" />

        <p>
	  Luckily, we have a lot of other options. A reasonable next candidate is a quadratic, a polynomial with a squared term instead of just a linear term. These have curvature to them. We can see that the best fit quadratic clearly captures the lift at the right hand side of the plot and the bend in the middle, but it also imposes a little lift on the left-hand side of the plot which is not obviously reflected in the data.
        </p>

        <img src="images/how_modeling_works/Quadratic_model.png" style="width: 600px;" />

        <p>
	  So, we can try other options. We can try polynomials with cubic terms, powers of three.
        </p>

        <img src="images/how_modeling_works/Cubic_model.png" style="width: 600px;" />

        <p>
	  Or we can look at a polynomial with quartic terms, powers of four.
	</p>
	 
        <img src="images/how_modeling_works/Quartic_model.png" style="width: 600px;" />

	<p>
	  We can also make models fit models that our polynomials of order five,
	</p>
	
        <img src="images/how_modeling_works/Quintic_model.png" style="width: 600px;" />
	
	<p>
	  polynomials of order six,
	</p>
	
        <img src="images/how_modeling_works/Sextic_model.png" style="width: 600px;" />
	
	<p>
	  seventh order polynomials,
	</p>
	
        <img src="images/how_modeling_works/Septic_model.png" style="width: 600px;" />

	<p>
	  and eighth order polynomials, also called <em>octic polynomials</em> (a useful tidbit for filling lulls in conversation at parties).
        </p>

        <img src="images/how_modeling_works/Octic_model.png" style="width: 600px;" />

        <p>
	  Now the fit appears to be getting better, but the line is taking on extra personality. It’s adopting wiggles.
	  If we take this to an extreme, we can imagine a model that passes through every single data point perfectly. This model would have zero error, zero deviation from our measured data. So does that make it the best fit model?
        </p>

        <img src="images/how_modeling_works/Interpolation_model.png" style="width: 600px;" />

        <p>
	  Models are useful because they allow us to generalize from one situation to another. When we use a model, we’re working under the assumption that there is some underlying pattern we want to measure, but it has some error on top of it. The goal of a good model is to look through the error and find the pattern.
        </p>

        <p>
	  The most common way to do this, is to split our data into two groups. We can use one group to train our model, and then we can test it to see how closely it fits the second group. The first group is the training data set, in the second group is the testing data set. There are lots of ways to do that, And we will revisit them later, but for now, we will randomly sort our years into two bins. We’ll put 70% of them into our training data set, and 30% of them into our testing data set.
        </p>

        <p>
	  Then, we can go back to our collection of model candidates and try them one by one. Here are a few of the models, trained on the training data, plotted with the testing data.
	</p>

        <img src="images/how_modeling_works/Linear_model_test.png" style="width: 400px;" />
        <img src="images/how_modeling_works/Quadratic_model_test.png" style="width: 400px;" />
        <img src="images/how_modeling_works/Cubic_model_test.png" style="width: 400px;" />
        <img src="images/how_modeling_works/Quintic_model_test.png" style="width: 400px;" />
        <img src="images/how_modeling_works/Octic_model_test.png" style="width: 400px;" />
        <img src="images/how_modeling_works/Interpolation_model_test.png" style="width: 400px;" />

	<p>
	  Here’s a plot showing the error on the training and testing data sets for each model.
	</p>
	
        <img src="images/how_modeling_works/fit_errors.png" style="width: 600px;" />
	<p>
	  Looking at the errors on the training data set, it appears that the error on the fifth order polynomial model is the lowest. All the higher order models are low too, but just a little higher. But careful inspection of testing error shows that the fourth-order model does the best job. At higher orders of polynomials, the error on the test data set gets higher. The more wiggly the line gets in fifth-and-higher order poklynomial models, the more it captures the quirks of the training data, rather than the underlying pattern of the testing data that we are interested in.
        </p>

        <p>
	  Based on this split-and-test approach we have a clear winner: of all the models we tried, the fourth-order polynomial is best.
        </p>

        <p>
	  Congratulations to us! We chose a pretty good model for our data. But there still are some pretty important ideas that we haven’t talked about yet.
          <a href="how_modeling_works_2.html">Join me for part 2</a> where we'll talk in more depth about what we want in a model.
        </p>

        <script type="text/javascript" src="javascripts/blog_signature.js"></script>
      </section>
    </div>
    <script type="text/javascript" src="javascripts/blog_footer.js"></script>
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-10180621-3");
      pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
