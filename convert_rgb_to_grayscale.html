<!DOCTYPE html>
<html>

  <script type="text/javascript">var blog_title = "How to Convert an RGB Image to Grayscale";</script>
  <script type="text/javascript">var publication_date = "November 13, 2019";</script>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <base target="_blank">
    <script type="text/javascript" src="javascripts/blog_head.js"></script>
  </head>
  <body>
    <script type="text/javascript" src="javascripts/blog_header.js"></script>
    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>
          Occasionally the need arises to convert a color image to grayscale.
          This need came up when loading images taken on the surface
          of Mars as part of
          <a href="https://end-to-end-machine-learning.teachable.com/p/advanced-neural-network-methods">
          End-to-End Machine Learning Course 313, Advanced Neural Network
          Methods</a>. We were working with a mixture of color and
          grayscale images and needed to transform them into a uniform
          format - all grayscale.
          We'll be working in Python using the Pillow,
          Numpy, and Matplotlib
          packages.
        </p>
        <p>
          The <a href="https://github.com/brohrer/cottonwood_martian_images/blob/master/image_loader.py">
            code we're working from</a> loads jpeg images for an autoencoder
            to use as inputs. This is accomplished with using Pillow and Numpy:
        </p>
        <p>
<pre><code>from PIL import Image
import numpy as np
color_img = np.asarray(Image.open(img_filename)) / 255</code></pre>
        </p>
        <p>
          This reads the image in and converts it into a Numpy array.
          For a detailed description of what this does and why, check
          out the prequel post to this one:
          <a href="https://brohrer.github.io/images_to_numbers.html">
            How to Convert a Picture into Numbers</a>.
          For grayscale images, the result is a two-dimensional array with the
          number of rows and columns equal to the number of pixel rows
          and columns in the image. Low numeric values indicate
          darker shades and higher values lighter shades. The range
          of pixel values is often 0 to 255. We divide by 255 to
          get a range of 0 to 1.
        </p>
        <p>
          Color images are represented as three-dimensional Numpy arrays -
          a collection of three two-dimensional arrays, one each for red,
          green, and blue channels. Each one, like grayscale arrays,
          has one value per pixel and their ranges are identical.
        </p>
        <p style="text-align:center;">
          <img title="Three dimensional image array structure"
            src="images/image_processing/three_d_array.png"
            alt="Three dimensional image array structure"
            style="height: 400px;">
        </p>

        <p style="text-align:center;">
        <img title="Color image with red, green, and blue channels"
          src="images/reign_pic_breakdown.png"
          alt="Color image with red, green, and blue channels and grayscale"
          style="height: 600px;">
        </p>

        <h3>Take the average channel value</h3>
        <p>
          An intuitive way to convert a color image 3D array to a grayscale
          2D array is, for each pixel, take the average of the red, green,
          and blue pixel values to get the grayscale value. This combines
          the "lightness" or luminance contributed by each color band into
          a reasonable gray approximation.
        </p>
        <p>
          <code>img = numpy.mean(color_img, axis=2)</code>
        </p>
        <p>
          The <code>axis=2</code> argument tells <code>numpy.mean()</code> to
          average values across all three color channels.
          (<code>axis=0</code> would average across pixel rows and
          <code>axis=1</code> would average across pixel columns.)
        </p>


        <script type="text/javascript" src="javascripts/blog_signature.js"></script>
      </section>
    </div>
    <script type="text/javascript" src="javascripts/blog_footer.js"></script>
    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-10180621-3");
      pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>
</html>
